import{l as v,a as g,b as f,j as r,B as u,C as _,c as y,d as C,e as m,L as l,T as b,I as o,s as c}from"./index-DjSoFkDJ.js";import{T as x}from"./TrilingualInput-WbYoNRY1.js";import{P as N,T as w}from"./trash-2-mCbCOaEC.js";import"./tabs-BUgrcuyl.js";const A=()=>{const{data:t,isLoading:j}=v(),{toast:n}=g(),d=f(),a=async(e,s)=>{const{error:i}=await c.from("projects").update(s).eq("id",e);i?n({title:"Error",description:i.message,variant:"destructive"}):(n({title:"Saved!"}),d.invalidateQueries({queryKey:["projects"]}))},p=async()=>{const e=t!=null&&t.length?Math.max(...t.map(i=>i.sort_order||0))+1:0,{error:s}=await c.from("projects").insert({title_en:"New Project",sort_order:e});s?n({title:"Error",description:s.message,variant:"destructive"}):(n({title:"Added!"}),d.invalidateQueries({queryKey:["projects"]}))},h=async e=>{const{error:s}=await c.from("projects").delete().eq("id",e);s?n({title:"Error",description:s.message,variant:"destructive"}):(n({title:"Deleted!"}),d.invalidateQueries({queryKey:["projects"]}))};return j?r.jsx("p",{children:"Loading..."}):r.jsxs("div",{className:"space-y-6 max-w-4xl",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Projects"}),r.jsxs(u,{onClick:p,children:[r.jsx(N,{className:"h-4 w-4 mr-2"}),"Add"]})]}),t==null?void 0:t.map(e=>r.jsxs(_,{children:[r.jsxs(y,{className:"flex flex-row items-center justify-between",children:[r.jsx(C,{children:e.title_en}),r.jsx(u,{variant:"ghost",size:"icon",onClick:()=>h(e.id),children:r.jsx(w,{className:"h-4 w-4 text-destructive"})})]}),r.jsxs(m,{className:"space-y-4",children:[r.jsx(x,{label:"Title",valueEn:e.title_en,valueBn:e.title_bn||"",valueAr:e.title_ar||"",onChangeEn:s=>a(e.id,{title_en:s}),onChangeBn:s=>a(e.id,{title_bn:s}),onChangeAr:s=>a(e.id,{title_ar:s})}),r.jsx(x,{label:"Description",multiline:!0,valueEn:e.description_en||"",valueBn:e.description_bn||"",valueAr:e.description_ar||"",onChangeEn:s=>a(e.id,{description_en:s}),onChangeBn:s=>a(e.id,{description_bn:s}),onChangeAr:s=>a(e.id,{description_ar:s})}),r.jsxs("div",{children:[r.jsx(l,{children:"Tags (JSON array)"}),r.jsx(b,{defaultValue:JSON.stringify(e.tags||[],null,2),onBlur:s=>{try{a(e.id,{tags:JSON.parse(s.target.value)})}catch{n({title:"Invalid JSON",variant:"destructive"})}},className:"font-mono text-xs",rows:3})]}),r.jsxs("div",{children:[r.jsx(l,{children:"Link"}),r.jsx(o,{defaultValue:e.link||"",onBlur:s=>a(e.id,{link:s.target.value})})]}),r.jsxs("div",{children:[r.jsx(l,{children:"Image URL"}),r.jsx(o,{defaultValue:e.image_url||"",onBlur:s=>a(e.id,{image_url:s.target.value})})]}),r.jsxs("div",{children:[r.jsx(l,{children:"Sort Order"}),r.jsx(o,{type:"number",defaultValue:e.sort_order||0,onBlur:s=>a(e.id,{sort_order:parseInt(s.target.value)})})]})]})]},e.id))]})};export{A as default};
