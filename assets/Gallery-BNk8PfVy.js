import{m as j,a as h,b as y,j as e,B as u,C as v,c as f,d as p,e as _,L as n,I as c,s as o}from"./index-CUeOdhnQ.js";import{P as w,T as N}from"./trash-2-Ew6vRLH_.js";const b=()=>{const{data:r,isLoading:x}=j(),{toast:t}=h(),d=y(),i=async(a,s)=>{const{error:l}=await o.from("gallery").update(s).eq("id",a);l?t({title:"Error",description:l.message,variant:"destructive"}):(t({title:"Saved!"}),d.invalidateQueries({queryKey:["gallery"]}))},m=async()=>{const a=r!=null&&r.length?Math.max(...r.map(l=>l.sort_order||0))+1:0,{error:s}=await o.from("gallery").insert({image_url:"",alt_text:"New Image",sort_order:a});s?t({title:"Error",description:s.message,variant:"destructive"}):(t({title:"Added!"}),d.invalidateQueries({queryKey:["gallery"]}))},g=async a=>{const{error:s}=await o.from("gallery").delete().eq("id",a);s?t({title:"Error",description:s.message,variant:"destructive"}):(t({title:"Deleted!"}),d.invalidateQueries({queryKey:["gallery"]}))};return x?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{className:"space-y-6 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Gallery"}),e.jsxs(u,{onClick:m,children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Add Image"]})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r==null?void 0:r.map(a=>e.jsxs(v,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between",children:[e.jsx(p,{className:"text-sm truncate",children:a.alt_text||"Image"}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>g(a.id),children:e.jsx(N,{className:"h-4 w-4 text-destructive"})})]}),e.jsxs(_,{className:"space-y-4",children:[a.image_url&&e.jsx("img",{src:a.image_url,alt:a.alt_text||"",className:"w-full h-40 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx(n,{children:"Image URL"}),e.jsx(c,{defaultValue:a.image_url,onBlur:s=>i(a.id,{image_url:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Alt Text"}),e.jsx(c,{defaultValue:a.alt_text||"",onBlur:s=>i(a.id,{alt_text:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Sort Order"}),e.jsx(c,{type:"number",defaultValue:a.sort_order||0,onBlur:s=>i(a.id,{sort_order:parseInt(s.target.value)})})]})]})]},a.id))})]})};export{b as default};
