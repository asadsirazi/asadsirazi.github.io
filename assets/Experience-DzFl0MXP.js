import{h as v,a as _,b as j,j as a,B as c,C as y,c as g,d as b,e as C,L as u,T as f,I as E,s as d}from"./index-DjSoFkDJ.js";import{T as l}from"./TrilingualInput-WbYoNRY1.js";import{P as N,T as B}from"./trash-2-mCbCOaEC.js";import"./tabs-BUgrcuyl.js";const I=()=>{const{data:s,isLoading:x}=v(),{toast:i}=_(),o=j(),r=async(e,n)=>{const{error:t}=await d.from("experiences").update(n).eq("id",e);t?i({title:"Error",description:t.message,variant:"destructive"}):(i({title:"Saved!"}),o.invalidateQueries({queryKey:["experiences"]}))},p=async()=>{const e=s!=null&&s.length?Math.max(...s.map(t=>t.sort_order||0))+1:0,{error:n}=await d.from("experiences").insert({title_en:"New Experience",sort_order:e});n?i({title:"Error",description:n.message,variant:"destructive"}):(i({title:"Added!"}),o.invalidateQueries({queryKey:["experiences"]}))},h=async e=>{const{error:n}=await d.from("experiences").delete().eq("id",e);n?i({title:"Error",description:n.message,variant:"destructive"}):(i({title:"Deleted!"}),o.invalidateQueries({queryKey:["experiences"]}))};return x?a.jsx("p",{children:"Loading..."}):a.jsxs("div",{className:"space-y-6 max-w-4xl",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Experience"}),a.jsxs(c,{onClick:p,children:[a.jsx(N,{className:"h-4 w-4 mr-2"}),"Add"]})]}),s==null?void 0:s.map(e=>a.jsxs(y,{children:[a.jsxs(g,{className:"flex flex-row items-center justify-between",children:[a.jsx(b,{children:e.title_en}),a.jsx(c,{variant:"ghost",size:"icon",onClick:()=>h(e.id),children:a.jsx(B,{className:"h-4 w-4 text-destructive"})})]}),a.jsxs(C,{className:"space-y-4",children:[a.jsx(l,{label:"Title",valueEn:e.title_en,valueBn:e.title_bn||"",valueAr:e.title_ar||"",onChangeEn:n=>r(e.id,{title_en:n}),onChangeBn:n=>r(e.id,{title_bn:n}),onChangeAr:n=>r(e.id,{title_ar:n})}),a.jsx(l,{label:"Company",valueEn:e.company_en||"",valueBn:e.company_bn||"",valueAr:e.company_ar||"",onChangeEn:n=>r(e.id,{company_en:n}),onChangeBn:n=>r(e.id,{company_bn:n}),onChangeAr:n=>r(e.id,{company_ar:n})}),a.jsx(l,{label:"Location",valueEn:e.location_en||"",valueBn:e.location_bn||"",valueAr:e.location_ar||"",onChangeEn:n=>r(e.id,{location_en:n}),onChangeBn:n=>r(e.id,{location_bn:n}),onChangeAr:n=>r(e.id,{location_ar:n})}),a.jsx(l,{label:"Period",valueEn:e.period_en||"",valueBn:e.period_bn||"",valueAr:e.period_ar||"",onChangeEn:n=>r(e.id,{period_en:n}),onChangeBn:n=>r(e.id,{period_bn:n}),onChangeAr:n=>r(e.id,{period_ar:n})}),a.jsxs("div",{children:[a.jsx(u,{children:"Responsibilities (JSON)"}),a.jsx(f,{defaultValue:JSON.stringify(e.responsibilities||[],null,2),onBlur:n=>{try{r(e.id,{responsibilities:JSON.parse(n.target.value)})}catch{i({title:"Invalid JSON",variant:"destructive"})}},className:"font-mono text-xs",rows:8})]}),a.jsxs("div",{children:[a.jsx(u,{children:"Sort Order"}),a.jsx(E,{type:"number",defaultValue:e.sort_order||0,onBlur:n=>r(e.id,{sort_order:parseInt(n.target.value)})})]})]})]},e.id))]})};export{I as default};
